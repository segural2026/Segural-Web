<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Segural | Producto</title>

  <style>
    :root{
      --bg:#ffffff; --muted:#f4f6f8; --text:#101828; --sub:#475467; --line:#e4e7ec;
      --blue:#2b6cb0; --blue2:#0b63ce; --shadow:0 10px 30px rgba(16,24,40,.08); --r:18px;
      --offer:#b54708; --offerBg: rgba(181,71,8,.12);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{
      position:sticky;top:0;z-index:1000;background:rgba(255,255,255,.92);backdrop-filter:blur(10px);
      border-bottom:1px solid var(--line);box-shadow:0 6px 20px rgba(16,24,40,.06);
    }
    .nav-wrap{max-width:1150px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:14px}
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text);font-weight:800;font-size:20px}
    .brand-badge{width:40px;height:40px;border-radius:14px;background:linear-gradient(135deg,var(--blue),#1f3c88);
      box-shadow:0 10px 20px rgba(43,108,176,.25);display:grid;place-items:center;color:#fff;font-weight:900}
    nav{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    .nav-link{text-decoration:none;color:var(--sub);padding:10px 12px;border-radius:12px;border:1px solid transparent;transition:.2s ease;font-weight:700;font-size:14px}
    .nav-link:hover{color:var(--text);background:var(--muted);border-color:var(--line)}
    .nav-link.primary{color:#fff;background:linear-gradient(135deg,var(--blue2),var(--blue));border-color:rgba(43,108,176,.25);box-shadow:0 10px 20px rgba(11,99,206,.20)}

    .container{max-width:1150px;margin:0 auto;padding:26px 18px 90px}
    .box{border:1px solid var(--line);border-radius:var(--r);background:#fff;box-shadow:var(--shadow);overflow:hidden}
    .top{padding:18px;border-bottom:1px solid var(--line);background:linear-gradient(180deg,#ffffff,#fafbfc)}
    .top h1{margin:0 0 6px 0;font-size:22px}
    .top p{margin:0;color:var(--sub);line-height:1.6}

    .content{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;padding:18px}
    .left{grid-column:span 6}
    .right{grid-column:span 6}

    .mainImg{
      border:1px solid var(--line);border-radius:16px;overflow:hidden;background:var(--muted);
      display:grid;place-items:center;min-height:320px;position:relative;
    }
    .mainImg img{width:100%;height:100%;object-fit:cover}

    .offer-pill{
      position:absolute;top:12px;left:12px;
      background:var(--offerBg);color:var(--offer);
      border:1px solid rgba(181,71,8,.25);
      font-weight:900;padding:8px 10px;border-radius:999px;
    }

    .thumbs{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .thumb{
      width:72px;height:54px;border-radius:12px;overflow:hidden;border:1px solid var(--line);
      background:#fff;cursor:pointer;opacity:.9;transition:.2s;
    }
    .thumb:hover{opacity:1;transform:translateY(-1px)}
    .thumb img{width:100%;height:100%;object-fit:cover}

    .badge{display:inline-block;padding:8px 10px;border-radius:999px;background:var(--muted);border:1px solid var(--line);font-weight:900;color:#344054;margin-bottom:10px}
    .price{display:inline-block;font-weight:900;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:var(--muted);margin:10px 0 12px}
    .desc{color:var(--sub);line-height:1.7}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 14px;border-radius:14px;border:1px solid rgba(11,99,206,.20);
      background:rgba(11,99,206,.08);color:var(--blue2);font-weight:900;text-decoration:none;transition:.2s ease}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.02)}
    .btn.wa{background:#25D366;color:#fff;border-color:rgba(255,255,255,.2);box-shadow:0 12px 26px rgba(0,0,0,.12)}
    .notfound{padding:16px;border:1px solid var(--line);border-radius:18px;background:var(--muted);color:var(--sub);font-weight:900}

    @media (max-width:900px){
      .left,.right{grid-column:span 12}
      .mainImg{min-height:260px}
    }
  </style>
</head>

<body>
  <header>
    <div class="nav-wrap">
      <a class="brand" href="index.html">
        <span class="brand-badge">S</span><span>Segural</span>
      </a>
      <nav>
        <a class="nav-link" href="index.html">Inicio</a>
        <a class="nav-link primary" href="productos.html">Productos</a>
        <a class="nav-link" href="admin.html">Admin</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="box" id="box" style="display:none;">
      <div class="top">
        <h1 id="name"></h1>
        <p>Detalle del producto</p>
      </div>

      <div class="content">
        <div class="left">
          <div class="mainImg" id="mainImg"></div>
          <div class="thumbs" id="thumbs"></div>
        </div>

        <div class="right">
          <div class="badge" id="cat"></div>
          <div class="price" id="price"></div>
          <div class="desc" id="desc"></div>

          <div class="actions">
            <a class="btn" href="productos.html">‚Üê Volver</a>
            <a class="btn wa" id="wa" href="#" target="_blank" rel="noopener">üí¨ Consultar WhatsApp</a>
          </div>
        </div>
      </div>
    </section>

    <div class="notfound" id="nf" style="display:none;">
      Producto no encontrado. Volv√© a <a href="productos.html">Productos</a>.
    </div>
  </main>

  <script>
    const WHATSAPP_NUMBER = "5491155034755";
    const STORAGE_KEY = "segural_products_v3";

    function moneyARS(value){
      const n = Number(value || 0);
      return n.toLocaleString("es-AR", { style: "currency", currency: "ARS", maximumFractionDigits: 0 });
    }

    function loadProducts(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        const arr = raw ? JSON.parse(raw) : [];
        return Array.isArray(arr) ? arr : [];
      }catch(e){ return []; }
    }

    function getId(){
      const url = new URL(location.href);
      return url.searchParams.get("id");
    }

    function buildWhatsAppLink(p){
      const priceTxt = p.precio ? (" - " + moneyARS(p.precio)) : " - Consultar precio";
      const text = `Hola Segural, quiero consultar por: ${p.nombre}${priceTxt}. Categoria: ${p.categoria}.`;
      return `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`;
    }

    function getImages(p){
      if(Array.isArray(p.imagenes) && p.imagenes.length) return p.imagenes;
      if(p.imagen) return [p.imagen];
      return [];
    }

    const id = getId();
    const all = loadProducts();
    const p = all.find(x => String(x.id) === String(id));

    const $box = document.getElementById("box");
    const $nf  = document.getElementById("nf");

    if(!p){
      $nf.style.display = "block";
    } else {
      document.title = `Segural | ${p.nombre}`;
      document.getElementById("name").textContent = p.nombre || "Producto";
      document.getElementById("cat").textContent = p.categoria || "Sin categor√≠a";
      document.getElementById("price").textContent = p.precio ? moneyARS(p.precio) : "Consultar precio";
      document.getElementById("desc").textContent = p.descripcion || "Sin descripci√≥n.";

      const imgs = getImages(p);

      const main = document.getElementById("mainImg");
      const thumbs = document.getElementById("thumbs");

      function setMain(src){
        main.innerHTML = "";
        if(!src){
          main.textContent = "Sin imagen";
          return;
        }

        // Oferta pill
        if(p.oferta){
          const pill = document.createElement("div");
          pill.className = "offer-pill";
          pill.textContent = "OFERTA";
          main.appendChild(pill);
        }

        const img = document.createElement("img");
        img.src = src;
        img.alt = p.nombre || "Producto";
        main.appendChild(img);
      }

      setMain(imgs[0] || "");

      thumbs.innerHTML = "";
      imgs.forEach((src) => {
        const t = document.createElement("div");
        t.className = "thumb";
        const im = document.createElement("img");
        im.src = src;
        im.alt = "miniatura";
        t.appendChild(im);
        t.onclick = () => setMain(src);
        thumbs.appendChild(t);
      });

      document.getElementById("wa").href = buildWhatsAppLink(p);
      $box.style.display = "block";
    }
  </script>
</body>
</html>
